<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daily Stock Update</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      font-size: 12px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 4px;
      text-align: center;
    }
    th {
      background: #f2f2f2;
    }
    .notes, .daily-sales {
      margin-top: 20px;
      text-align: left;
    }
    .notes ul {
      list-style-type: disc;
      padding-left: 20px;
      display: flex;
      gap: 40px;
    }
    .controls {
      margin-top: 20px;
      display: flex;
      gap: 10px;
    }
  </style>
</head>
<body>
  <h2>Daily Stock Update</h2>

  <!-- Date input -->
  <label>Date: <input type="date" id="dateInput"></label>

  <div id="main-content">
    <table>
      <thead>
        <tr>
          <th>Item</th>
          <th>Opening Stock</th>
          <th>Closing Stock</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Sloppy Joe</td>
          <td><input type="text" placeholder="Opening"></td>
          <td><input type="text" placeholder="Closing"></td>
          <td>
            <label><input type="checkbox"> Beli</label>
            <label><input type="checkbox"> Bawak</label>
          </td>
        </tr>
        <tr>
          <td>Smash Burger</td>
          <td><input type="text" placeholder="Opening"></td>
          <td><input type="text" placeholder="Closing"></td>
          <td>
            <label><input type="checkbox"> Beli</label>
            <label><input type="checkbox"> Bawak</label>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Notes -->
    <div class="notes">
      <strong>Notes:</strong>
      <ul>
        <li><input type="text" placeholder="Note 1"></li>
        <li><input type="text" placeholder="Note 2"></li>
        <li><input type="text" placeholder="Note 3"></li>
      </ul>
    </div>

    <!-- Daily Sales -->
   <h3>Daily Sales</h3>
    <div class="sales">
      <input type="number" id="dailySales" placeholder="Enter daily sales (RM)">
    </div>
  </div>
</div>
<!-- End mainContent -->

<button onclick="downloadPDF()">â¬‡ Download PDF</button>
<button class="clear-btn" onclick="clearAll()">ðŸ—‘ Clear All</button>
<button onclick="saveData()">ðŸ’¾ Save</button>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
// Categories + items
const categories = {
  "Patty": ["Daging","Ayam", "Kambing", "Sloppy Joe", "Smash Burger", "Crispy Chicken"],
  "Oblong": ["Daging","Ayam", "Kambing"],
  "Bread / Burger / Wrap": ["Bun", "Wrap","Oblong"],
  "Sauces & Spices": [
    "Chili Sauce", "Mayonnaise", "Special Sauce", "Cheese sauce", "Paprika Powder", "Curry Powder", "Garlic Powder", "Cayenne", "Worcestershire", "Black Pepper", "White Pepper", "Tomato Puree"
  ],
  "Cheese": ["Cheese Slice", "Cream Cheese"],
  "Sayur": ["Onion", "Cucumber", "Salad"],
  "Others": ["Paper Wrapping", "Fries", "Egg"]
};

const tbody = document.querySelector("#stockTable tbody");

// Generate rows
Object.keys(categories).forEach(cat => {
  tbody.innerHTML += `<tr class="category"><td colspan="4">${cat}</td></tr>`;
  categories[cat].forEach(item => {
    let rowHTML = "";

    // Special cases
    if (item === "Sloppy Joe" || item === "Black Pepper" || item === "White Pepper") {
      rowHTML = `<tr>
        <td>${item}</td>
        <td><input type="text" id="open-${item}" placeholder="Opening"></td>
        <td><input type="text" id="close-${item}" placeholder="Closing"></td>
        <td>
          <label><input type="checkbox" id="beli-${item}"> Beli</label>
          <label><input type="checkbox" id="bawak-${item}"> Bawak</label>
        </td>
      </tr>`;
    } else if (item === "Smash Burger") {
      rowHTML = `<tr>
        <td>${item}</td>
        <td><input type="number" id="openPcs-${item}" placeholder="Pcs"> pcs</td>
        <td><input type="number" id="closePcs-${item}" placeholder="Pcs"> pcs</td>
        <td>
          <label><input type="checkbox" id="beli-${item}"> Beli</label>
          <label><input type="checkbox" id="bawak-${item}"> Bawak</label>
        </td>
      </tr>`;
    } else if (item === "Egg") {
      rowHTML = `<tr>
        <td>${item}</td>
        <td>
          <input type="number" id="openCtn-${item}" placeholder="Ctn"> ctn
          <input type="number" id="openPcs-${item}" placeholder="Pcs"> pcs
        </td>
        <td>
          <input type="number" id="closeCtn-${item}" placeholder="Ctn"> ctn
          <input type="number" id="closePcs-${item}" placeholder="Pcs"> pcs
        </td>
        <td>
          <label><input type="checkbox" id="beli-${item}"> Beli</label>
          <label><input type="checkbox" id="bawak-${item}"> Bawak</label>
        </td>
      </tr>`;
    } else if (item === "Tomato Puree") {
      rowHTML = `<tr>
        <td>${item}</td>
        <td><input type="number" id="openCans-${item}" placeholder="Cans"> cans</td>
        <td><input type="number" id="closeCans-${item}" placeholder="Cans"> cans</td>
        <td>
          <label><input type="checkbox" id="beli-${item}"> Beli</label>
          <label><input type="checkbox" id="bawak-${item}"> Bawak</label>
        </td>
      </tr>`;
    } else if (["Sauces & Spices", "Cheese", "Sayur"].includes(cat)) {
      rowHTML = `<tr>
        <td>${item}</td>
        <td><input type="text" id="open-${item}" placeholder="Opening"></td>
        <td><input type="text" id="close-${item}" placeholder="Closing"></td>
        <td>
          <label><input type="checkbox" id="beli-${item}"> Beli</label>
          <label><input type="checkbox" id="bawak-${item}"> Bawak</label>
        </td>
      </tr>`;
    } else {
      rowHTML = `<tr>
        <td>${item}</td>
        <td>
          <input type="number" id="openPkt-${item}" placeholder="Pkt"> pkt
          <input type="number" id="openPcs-${item}" placeholder="Pcs"> pcs
        </td>
        <td>
          <input type="number" id="closePkt-${item}" placeholder="Pkt"> pkt
          <input type="number" id="closePcs-${item}" placeholder="Pcs"> pcs
        </td>
        <td>
          <label><input type="checkbox" id="beli-${item}"> Beli</label>
          <label><input type="checkbox" id="bawak-${item}"> Bawak</label>
        </td>
      </tr>`;
    }
    tbody.innerHTML += rowHTML;
  });
});

      // Generate PDF
      const imgData = canvas.toDataURL("image/png");
      const pdf = new jsPDF("p", "mm", "a4");
      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();
      const ratio = Math.min(pageWidth / canvas.width, pageHeight / canvas.height);
      const imgWidth = canvas.width * ratio;
      const imgHeight = canvas.height * ratio;

      // âœ… Add date text at top of PDF
      pdf.setFontSize(12);
      pdf.text(`Date: ${selectedDate}`, 10, 10);

      // Shift content slightly down to avoid overlapping date
      pdf.addImage(imgData, "PNG", 0, 15, imgWidth, imgHeight);
      pdf.save(filename);
    }

    // âœ… Password-protected Clear All
    function clearAll() {
      const password = prompt("Enter password to clear all:");
      if (password === "123") {
        document.querySelectorAll("input[type=text], input[type=date]").forEach(el => el.value = "");
        document.querySelectorAll("input[type=checkbox]").forEach(cb => cb.checked = false);
      } else {
        alert("Incorrect password!");
      }
    }
  </script>
</body>
</html>

