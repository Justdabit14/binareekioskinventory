<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daily Stock Update</title>
  <style>
body { font-family: Arial, sans-serif; margin: 10px; }
h1 { text-align: center; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
input[type="number"] { width: 50px; text-align: center; margin: 2px; }
button { margin: 10px 5px; padding: 10px; background: #4CAF50; color: white; border: none; border-radius: 6px; }
.category { background: #f0f0f0; font-weight: bold; text-align: left; }


/* NEW: left-align item names (first column only) */
td:first-child { 
  text-align: left; 
  padding-left: 8px; 
}

/* NEW: left-align notes + daily sales text boxes */
.notes {
  margin-top: 20px;
  text-align: left;   /* align everything to the left */
}

.notes ul {
  list-style-type: disc;  /* normal bullet points */
  padding-left: 20px;     /* spacing before bullets */
}

.notes li {
  margin-bottom: 6px;     /* spacing between bullets */
}

.notes input {
  width: 80%;             /* make input span nicely */
  text-align: left; 
  padding: 4px;
}

.clear-btn{
  margin: 10px 5px;
  padding: 10px;
  background: #f44336;   /* red for warning */
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
  </style>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4CAF50">

</head>
<body>

  <h1>Daily Stock Update</h1>
  <label>Date: <input type="date" id="date"></label>

  <table id="stockTable">
    <thead>
      <tr>
        <th>Item</th>
        <th>Opening</th>
        <th>Closing</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <!-- Rows generated by JS -->
    </tbody>
  </table>

  <!-- Notes & Sales -->
  <div class="bottom-section">
    <h3>Notes</h3>
    <div class="notes">
      <input type="text" id="note1" placeholder="â€¢ Note 1">
      <input type="text" id="note2" placeholder="â€¢ Note 2">
      <input type="text" id="note3" placeholder="â€¢ Note 3">
    </div>

    <h3>Daily Sales</h3>
    <div class="sales">
      <input type="number" id="dailySales" placeholder="Enter daily sales (RM)">
    </div>
  </div>

  <button onclick="downloadPDF()">â¬‡ Download PDF</button>
  <button class="clear-btn" onclick="clearAll()">ðŸ—‘ Clear All</button>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    // Categories + items
    const categories = {
      "Patty": ["Daging","Ayam", "Kambing", "Sloppy Joe", "Smash Burger", "Crispy Chicken"],
      "Oblong": ["Daging","Ayam", "Kambing"],
      "Bread / Burger / Wrap": ["Bun", "Wrap","Oblong"],
      "Sauces & Spices": ["Chili Sauce", "Mayonnaise", "Special Sauce", "Cheese sauce", "Paprika Powder", "Curry Powder", "Garlic Powder", "Cayenne", "Worcestershire"],
      "Cheese": ["Cheese Slice", "Cream Cheese"],
      "Sayur": ["Onion", "Cucumber", "Salad"],
      "Others": ["Paper Wrapping", "Fries" ]
    };

    const tbody = document.querySelector("#stockTable tbody");

    // Generate table rows (pkt/pcs for countable items, text for sauces/spices/cheese/sayur)
    Object.keys(categories).forEach(cat => {
      tbody.innerHTML += `<tr class="category"><td colspan="4">${cat}</td></tr>`;
      categories[cat].forEach(item => {
        let rowHTML = "";
        if (["Sauces & Spices", "Cheese", "Sayur"].includes(cat)) {
          // Free text inputs for these
          rowHTML = `
            <tr>
              <td>${item}</td>
              <td><input type="text" id="open-${item}" placeholder="Opening"></td>
              <td><input type="text" id="close-${item}" placeholder="Closing"></td>
              <td>
                <label><input type="checkbox" id="beli-${item}"> Beli</label>
                <label><input type="checkbox" id="bawak-${item}"> Bawak</label>
              </td>
            </tr>`;
        } else {
          // Pkt & pcs for countable items
          rowHTML = `
            <tr>
              <td>${item}</td>
              <td>
                <input type="number" min="0" id="openPkt-${item}" placeholder="Pkt"> pkt
                <input type="number" min="0" id="openPcs-${item}" placeholder="Pcs"> pcs
              </td>
              <td>
                <input type="number" min="0" id="closePkt-${item}" placeholder="Pkt"> pkt
                <input type="number" min="0" id="closePcs-${item}" placeholder="Pcs"> pcs
              </td>
              <td>
                <label><input type="checkbox" id="beli-${item}"> Beli</label>
                <label><input type="checkbox" id="bawak-${item}"> Bawak</label>
              </td>
            </tr>`;
        }
        tbody.innerHTML += rowHTML;
      });
    });

    // PDF Export
    async function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const date = document.getElementById("date").value || "(No Date)";

      doc.setFontSize(16);
      doc.text("Daily Stock Update", 14, 20);
      doc.setFontSize(12);
      doc.text("Date: " + date, 14, 28);

      let startY = 40;

      Object.keys(categories).forEach(cat => {
        doc.setFontSize(13);
        doc.text(cat, 14, startY);
        startY += 6;

        doc.setFontSize(11);
        doc.text("Item", 14, startY);
        doc.text("Opening", 70, startY);
        doc.text("Closing", 120, startY);
        doc.text("Status", 170, startY);
        startY += 6;

        categories[cat].forEach(item => {
          let opening = "";
          let closing = "";

          if (["Sauces & Spices", "Cheese", "Sayur"].includes(cat)) {
            opening = document.getElementById(`open-${item}`).value || "-";
            closing = document.getElementById(`close-${item}`).value || "-";
          } else {
            const openPkt = document.getElementById(`openPkt-${item}`).value || "-";
            const openPcs = document.getElementById(`openPcs-${item}`).value || "-";
            const closePkt = document.getElementById(`closePkt-${item}`).value || "-";
            const closePcs = document.getElementById(`closePcs-${item}`).value || "-";
            opening = openPkt + " pkt / " + openPcs + " pcs";
            closing = closePkt + " pkt / " + closePcs + " pcs";
          }

          const beli = document.getElementById(`beli-${item}`).checked ? "Beli" : "";
          const bawak = document.getElementById(`bawak-${item}`).checked ? "Bawak" : "";
          const status = [beli, bawak].filter(Boolean).join(", ") || "-";

          doc.text(item, 14, startY);
          doc.text(opening, 70, startY);
          doc.text(closing, 120, startY);
          doc.text(status, 170, startY);

          startY += 6;
          if (startY > 270) { // new page if too long
            doc.addPage();
            startY = 20;
          }
        });

        startY += 6; // space between categories
      });

      // Notes
      doc.setFontSize(13);
      doc.text("Notes:", 14, startY);
      startY += 6;
      ["note1", "note2", "note3"].forEach((id, i) => {
        const val = document.getElementById(id).value || "";
        doc.text("â€¢ " + val, 20, startY);
        startY += 6;
      });

      // Daily Sales
      startY += 6;
      const sales = document.getElementById("dailySales").value || "-";
      doc.text("Daily Sales: RM " + sales, 14, startY);

      doc.save("daily_stock_" + date + ".pdf");
    }

    function clearAll() {
  const password = prompt("Enter password to clear all:");
  if (password === "123") {   // You can change the password here
    // Clear all inputs & checkboxes
    document.querySelectorAll("input[type='number'], input[type='text']").forEach(input => input.value = "");
    document.querySelectorAll("input[type='checkbox']").forEach(chk => chk.checked = false);
    alert("All fields cleared!");
  } else if (password !== null) {
    alert("Incorrect password!");
  }
}
  </script>
  
<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js")
      .then(() => console.log("Service Worker registered"));
  }
</script>  
</body>
</html>